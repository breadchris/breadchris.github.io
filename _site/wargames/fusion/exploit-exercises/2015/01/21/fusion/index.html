<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Exploit Exercises - Fusion Level01 &#8211; A Little (1 << 3) + y</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Poping a shell on the first Fusion challenge">
    <meta name="author" content="Chris">
    <meta name="keywords" content="wargames, fusion, exploit-exercises">
    <link rel="canonical" href="breadchris.github.io/wargames/fusion/exploit-exercises/2015/01/21/fusion/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for A Little (1 << 3) + y" href="/feed.xml" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css?201508120112" type="text/css">
    <link rel="stylesheet" href="/css/prism.css?201508120112" type="text/css">

    <!-- Fonts -->
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    
      <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    


    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Exploit Exercises - Fusion Level01">
    <meta property="og:description" content="Blades out like Wolverine, but it was all a huge act man. ~ octobersveryown">
    <meta property="og:url" content="breadchris.github.io/wargames/fusion/exploit-exercises/2015/01/21/fusion/">
    <meta property="og:site_name" content="A Little (1 &lt;&lt; 3) + y">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    
        <meta name="twitter:site" content="@breadchris" />
    
    <meta name="twitter:title" content="Exploit Exercises - Fusion Level01" />
    <meta name="twitter:description" content="Poping a shell on the first Fusion challenge" />
    <meta name="twitter:url" content="breadchris.github.io/wargames/fusion/exploit-exercises/2015/01/21/fusion/" />

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
        
    
    <script src="/js/prisim.js"></script>
</head>

<body class="site">
  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="breadchris.github.io" class="site-title">A Little (1 << 3) + y</a>
      <nav class="site-nav">
        <a href="/about/">About</a>
<a href="/contact/">Contact</a>

      </nav>
      <div class="clearfix"></div>
      
        <div class="social-icons">
  <div class="left">
    
      <a class="fa fa-github" href="https://github.com/breadchris"></a>
    
    
    <a class="fa fa-rss" href="/feed.xml"></a>
    
      <a class="fa fa-twitter" href="https://twitter.com/breadchris"></a>
    
    
    
    
    
  </div>
  <div class="right">
    
    
    
  </div>
</div>
<div class="clearfix"></div>

      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
  <h1>Exploit Exercises - Fusion Level01</h1>
  <span class="post-meta">Jan 21, 2015</span><br>
    
  <span class="post-meta small">
  
    1 minute read
  
  </span>
</div>

<article class="post-content">
  <p>Challenge: <a href="https://exploit-exercises.com/fusion/level01/" title="Fusion Level01" target="_blank">here</a></p>

<p>This level was pretty much the same code as the previous level, except we no longer have <a href="http://en.wikipedia.org/wiki/Address_space_layout_randomization" title="ASLR" target="_blank">ASLR</a> turned off and the address leak of our buffer is no longer available to us:</p>

<p>[c]
printf(“[debug] buffer is at 0x%08x :-)\n”, buffer); :D
[/c]</p>

<p>While we really did not need this in the first challenge, because we could have used a dynamic debugger such as <a href="http://www.gnu.org/software/gdb/" title="gdb" target="_blank">gdb</a> to see where our buffer was in memory. </p>

<p>We do however, still have an executable stack. This tells us that we can still run our shellcode making our payload pretty similar to what it was in the previous level.</p>

<p>It would be really nice to be able to get the eip register to point to our shellcode… let’s checkout what happens right before the function <code>fix_path</code> returns using gdb.</p>

<p>We start out by sshing into the fusion vm and startup gdb as root:</p>

<p>[bash]
[~]$ ssh fusion@<ip address="" of="" fusion="" vm="">
fusion@172.16.76.131's password: 
fusion@fusion:~$ sudo gdb
(gdb) 
[/bash]</ip></p>

<p>Making a little python script that uses sockets to establish a connection to the fusion vm on the same port that the level01 program is listening on (20001) we can run the program and then attach to the child process on the fusion vm:</p>

<p>[bash]
(gdb) shell pgrep level01</p>

<p>[/bash]</p>

</article>









      </div>
    </div>
  </div>

  <footer class="center">
  <div class="measure">
    <small>
      Theme crafted with &lt;3 by <a href="http://johnotander.com">John Otander</a> (<a href="https://twitter.com/4lpine">@4lpine</a>).
    </small>
  </div>
</footer>

</body>
</html>
