<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Exploit Exercises - Fusion Level01</title>
  <meta name="description" content="Challenge: here">

  <link href='https://fonts.googleapis.com/css?family=Open+Sans:600,700|Droid+Serif:400,700' rel='stylesheet' type='text/css'>
  
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/wargames/fusion/exploit-exercises/2015/01/21/fusion/">
  <link rel="alternate" type="application/rss+xml" title="See you, %20 cowboy" href="http://localhost:4000/feed.xml">

  <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
</head>


  <body>
    <div class="site-wrap">
      <header class="site-header">
  <div class="wrapper">
    <a class="site-title" href="http://localhost:4000/">See you, %20 cowboy</a>
    <span class="site-description">A most excellent adventure in hacking</span>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        

        <a href="/feed.xml" class="page-link">RSS</a>
      </div>
    </nav>
  </div>
</header>


      <div class="page-content">
        <div class="wrapper">
          <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Exploit Exercises - Fusion Level01</h1>
    <p class="post-meta"><time datetime="2015-01-21T04:00:00-08:00" itemprop="datePublished">January 21, 2015</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>Challenge: <a href="https://exploit-exercises.com/fusion/level01/" title="Fusion Level01" target="_blank">here</a></p>

<p>This level was pretty much the same code as the previous level, except we no longer have <a href="http://en.wikipedia.org/wiki/Address_space_layout_randomization" title="ASLR" target="_blank">ASLR</a> turned off and the address leak of our buffer is no longer available to us:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">printf</span><span class="p">(</span><span class="s">"[debug] buffer is at 0x%08x :-)</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">buffer</span><span class="p">);</span> <span class="o">:</span><span class="n">D</span></code></pre></figure>

<p>While we really did not need this in the first challenge, because we could have used a dynamic debugger such as <a href="http://www.gnu.org/software/gdb/" title="gdb" target="_blank">gdb</a> to see where our buffer was in memory.</p>

<p>We do however, still have an executable stack. This tells us that we can still run our shellcode making our payload pretty similar to what it was in the previous level.</p>

<p>It would be really nice to be able to get the eip register to point to our shellcodeâ€¦ letâ€™s checkout what happens right before the function <code class="highlighter-rouge">fix_path</code> returns using gdb.</p>

<p>We start out by sshing into the fusion vm and startup gdb as root:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">[~]$ </span>ssh fusion@&lt;ip address of fusion vm&gt;
fusion@172.16.76.131<span class="s1">'s password: 
fusion@fusion:~$ sudo gdb
(gdb) </span></code></pre></figure>

<p>Making a little python script that uses sockets to establish a connection to the fusion vm on the same port that the level01 program is listening on (20001) we can run the program and then attach to the child process on the fusion vm:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">(</span>gdb<span class="o">)</span> shell pgrep level01</code></pre></figure>


  </div>

</article>

        </div>
      </div>

      <footer class="site-footer">
  <div class="wrapper">
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <div class="social-media-list">
          
            <a href="mailto:chris@vgcs.io">Email</a>
          

          
            <a href="https://github.com/breadchris">Github</a>
          

          
            <a href="https://twitter.com/breadchris">Twitter</a>
          
        </div>
      </div>

      <div class="footer-col footer-col-2">
        <p>Theme made by <a href="http://masha.space/">Masha Safina</a>. Codes available on <a href="https://github.com/mashlo/captains-log">GitHub</a> ðŸ––</p>
      </div>
    </div>
  </div>
</footer>

    </div>
  </body>

</html>
